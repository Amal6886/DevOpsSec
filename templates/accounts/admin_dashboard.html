{% extends 'base.html' %}

{% block title %}Admin Dashboard - Diet--Planner{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="mb-4">
            <i class="bi bi-speedometer2"></i> Admins Dashboard
        </h1>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-white bg-primary">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-subtitle mb-2">Total Users</h6>
                        <h2 class="mb-0">{{ total_users }}</h2>
                    </div>
                    <i class="bi bi-people" style="font-size: 3rem; opacity: 0.5;"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-success">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-subtitle mb-2">Total Products</h6>
                        <h2 class="mb-0">{{ total_products }}</h2>
                    </div>
                    <i class="bi bi-box-seam" style="font-size: 3rem; opacity: 0.5;"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-info">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-subtitle mb-2">Total Orders</h6>
                        <h2 class="mb-0">{{ total_orders }}</h2>
                    </div>
                    <i class="bi bi-bag-check" style="font-size: 3rem; opacity: 0.5;"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-warning">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6 class="card-subtitle mb-2">Pending Orders</h6>
                        <h2 class="mb-0">{{ pending_orders }}</h2>
                    </div>
                    <i class="bi bi-clock-history" style="font-size: 3rem; opacity: 0.5;"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-6">
        <div class="card text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <div class="card-body">
                <h5 class="card-title mb-3">
                    <i class="bi bi-currency-dollar"></i> Total Revenue
                </h5>
                <h2 class="mb-0">${{ total_revenue|floatformat:2 }}</h2>
                <p class="text-white-50 mb-0 mt-2">From completed orders</p>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card text-white bg-danger">
            <div class="card-body">
                <h5 class="card-title mb-3">
                    <i class="bi bi-exclamation-triangle"></i> Low Stock Alerts
                </h5>
                <h2 class="mb-0">{{ total_low_stock }}</h2>
                <p class="text-white-50 mb-0 mt-2">Products need restocking</p>
            </div>
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title mb-4">
                    <i class="bi bi-tools"></i> Quick Actions
                </h5>
                <div class="row">
                    <div class="col-md-3 mb-3">
                        <a href="{% url 'products:admin_product_list' %}" class="btn btn-primary w-100 h-100 d-flex flex-column align-items-center justify-content-center" style="min-height: 120px;">
                            <i class="bi bi-box-seam" style="font-size: 2.5rem; margin-bottom: 10px;"></i>
                            <span>Manage Products</span>
                        </a>
                    </div>
                    <div class="col-md-3 mb-3">
                        <a href="{% url 'products:create_supplement' %}" class="btn btn-success w-100 h-100 d-flex flex-column align-items-center justify-content-center" style="min-height: 120px;">
                            <i class="bi bi-plus-circle" style="font-size: 2.5rem; margin-bottom: 10px;"></i>
                            <span>Add Supplement</span>
                        </a>
                    </div>
                    <div class="col-md-3 mb-3">
                        <a href="{% url 'products:create_protein_bar' %}" class="btn btn-info w-100 h-100 d-flex flex-column align-items-center justify-content-center" style="min-height: 120px;">
                            <i class="bi bi-plus-circle" style="font-size: 2.5rem; margin-bottom: 10px;"></i>
                            <span>Add Protein Bar</span>
                        </a>
                    </div>
                    <div class="col-md-3 mb-3">
                        <a href="{% url 'orders:admin_order_list' %}" class="btn btn-warning w-100 h-100 d-flex flex-column align-items-center justify-content-center" style="min-height: 120px;">
                            <i class="bi bi-clipboard-data" style="font-size: 2.5rem; margin-bottom: 10px;"></i>
                            <span>Manage Orders</span>
                        </a>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-3 mb-3">
                        <a href="{% url 'admin:index' %}" class="btn btn-secondary w-100 h-100 d-flex flex-column align-items-center justify-content-center" style="min-height: 120px;">
                            <i class="bi bi-gear" style="font-size: 2.5rem; margin-bottom: 10px;"></i>
                            <span>Django Admin</span>
                        </a>
                    </div>
                    <div class="col-md-3 mb-3">
                        <a href="{% url 'admin:accounts_user_changelist' %}" class="btn btn-dark w-100 h-100 d-flex flex-column align-items-center justify-content-center" style="min-height: 120px;">
                            <i class="bi bi-people" style="font-size: 2.5rem; margin-bottom: 10px;"></i>
                            <span>Manage Users</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title mb-3">
                    <i class="bi bi-exclamation-triangle text-danger"></i> Low Stock Products
                </h5>
                {% if total_low_stock > 0 %}
                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Stock</th>
                                <th>Threshold</th>
                                <th>Type</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for supplement in low_stock_supplements %}
                            <tr class="table-warning">
                                <td>{{ supplement.name }}</td>
                                <td><span class="badge bg-danger">{{ supplement.stock_quantity }}</span></td>
                                <td>{{ supplement.threshold }}</td>
                                <td><span class="badge bg-primary">Supplement</span></td>
                            </tr>
                            {% endfor %}
                            {% for bar in low_stock_bars %}
                            <tr class="table-warning">
                                <td>{{ bar.name }}</td>
                                <td><span class="badge bg-danger">{{ bar.stock_quantity }}</span></td>
                                <td>{{ bar.threshold }}</td>
                                <td><span class="badge bg-info">Protein Bar</span></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <p class="text-muted mb-0">No low stock products. All products are well stocked!</p>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title mb-3">
                    <i class="bi bi-clock-history"></i> Recent Orders
                </h5>
                {% if recent_orders %}
                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for order in recent_orders %}
                            <tr>
                                <td>#{{ order.id }}</td>
                                <td>{{ order.user.username }}</td>
                                <td>${{ order.total_amount }}</td>
                                <td>
                                    <span class="badge bg-{% if order.status == 'delivered' %}success{% elif order.status == 'cancelled' %}danger{% elif order.status == 'pending' %}warning{% else %}info{% endif %}">
                                        {{ order.get_status_display }}
                                    </span>
                                </td>
                                <td>
                                    <a href="{% url 'orders:admin_order_detail' order.id %}" class="btn btn-sm btn-primary">
                                        <i class="bi bi-eye"></i>
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="text-center mt-3">
                    <a href="{% url 'orders:admin_order_list' %}" class="btn btn-sm btn-outline-primary">View All Orders</a>
                </div>
                {% else %}
                <p class="text-muted mb-0">No orders yet.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

